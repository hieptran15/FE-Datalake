<nb-layout>
  <nb-layout-column
    style=" padding-right: 0 !important;padding-left: 0 !important;padding-top: 15.6px !important;"
    [nbSpinner]="isLoading" [nbSpinnerMessage]="'process.processing' | translate" nbSpinnerStatus="primary">
    <nb-card>
      <nb-card-header>
        <div [formGroup]="formGroup">
          <div class="d-flex justify-content-between align-items-center">
            <div class="title-page">
              LB connection
            </div>
            <div class="d-flex align-items-center" style="font-size: 12px ; font-weight:400">

            </div>
          </div>
        </div>
      </nb-card-header>
      <nb-card-body>
        <div style="margin-bottom: 25px;margin-top: 20px;" class="d-flex justify-content-between align-items-center">
          <div style="padding: 0 6px" class="col-3 d-flex page align-items-center">
            <span>{{'Hiển thị'}}</span>
            <ng-select [items]="limits"
                       class="selectPage"
                       bindLabel="name"
                       [(ngModel)]="limit"
                       [clearable]="false"
                       appendTo="">
            </ng-select>
            <span>{{'bản ghi'}}</span>
          </div>
          <div class="d-flex align-items-center" style="font-size: 12px ; font-weight:400">

            <div style="margin-right: 10px">
              <nb-form-field style="position: relative">
                <input nbInput fullWidth trim="blur" style="padding-left: 10px" class="input-edit"
                       [(ngModel)]="textSearch"
                       placeholder="Nội dung tìm kiếm"
                       (keyup.enter)="filterSearchTable()">
                <nb-icon nbPrefix icon="search-outline" pack="eva"
                         style="position: absolute;top: 10px;z-index: 3; right: 10px;"></nb-icon>
              </nb-form-field>
            </div>

            <!--            <ng-select-->
            <!--              [selectableGroup]="true"-->
            <!--              [closeOnSelect]="true"-->
            <!--              [clearable]="false"-->
            <!--              appendTo=""-->
            <!--              (change)="filterSearchTable()"-->
            <!--              [items]="listTypeSearch" bindLabel="name" style="width: 150px;"-->
            <!--              bindValue="value" [(ngModel)]="typeSearch"-->
            <!--              placeholder="{{'global.select.placeholder' |translate}}"-->
            <!--            >-->
            <!--            </ng-select>-->
            <div style="margin: 0 16px" class="edit-button position-relative">
              <button (click)="openBoxFiler()" nbTooltip="Filter"
                      style="height: 35px;width: 41px; padding: 5px 1px; color: white; min-width: 0 !important;"
                      class="d-flex justify-content-center align-items-center">
                <nb-icon nbPrefix icon="funnel-outline" pack="eva"></nb-icon>
                <div *ngIf="listFilterSelected.length < 1">
                  <svg width="7" height="4" viewBox="0 0 7 4" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M0.58875 0H6.41125C6.93479 0 7.19655 0.620174 6.82714 0.981742L3.91589 3.83119C3.68593 4.05627 3.31407 4.05627 3.08655 3.83119L0.172857 0.981742C-0.196554 0.620174 0.065214 0 0.58875 0Z"
                      fill="white"/>
                  </svg>
                </div>
                <div *ngIf="listFilterSelected.length > 0">{{listFilterSelected.length}}</div>
              </button>
              <div *ngIf="isFilerBox"
                   class="support-filter position-absolute">
                <ng-select
                  [selectableGroup]="true"
                  [closeOnSelect]="true"
                  [clearable]="false"
                  appendTo=""
                  [items]="listTypeSearch" bindLabel="name" style="width: 200px;margin: 15px auto;"
                  bindValue="value" [(ngModel)]="typeSearch"
                  placeholder="{{'global.select.placeholder' |translate}}"
                >
                </ng-select>
                <!--                <table style="margin: 10px 16px">-->
                <!--                  <tr class="table-row-listUser-header">-->
                <!--                    <th style="width: 50%"></th>-->
                <!--                    <th style="width: 50%"></th>-->
                <!--                    <th style="width: 0px"></th>-->
                <!--                  </tr>-->
                <!--                  <tr style="margin-bottom: 10px" [formGroup]="row"-->
                <!--                      *ngFor="let row of listFilterForm.controls; let i = index"-->
                <!--                      class="table-row-listUser">-->
                <!--                    <td class="position-relative">-->
                <!--                      <ng-select-->
                <!--                        class="edit-select"-->
                <!--                        formControlName="typeFilter"-->
                <!--                        placeholder="Lọc theo"-->
                <!--                        appendTo=""-->
                <!--                        (change)="filterChange(row, i)"-->
                <!--                      >-->
                <!--                        <ng-option *ngFor="let item of listTypeSearch" [value]="item?.value">-->
                <!--                          {{item?.name}}-->
                <!--                        </ng-option>-->
                <!--                      </ng-select>-->
                <!--                    </td>-->
                <!--                    <td>-->
                <!--                      <ng-select-->
                <!--                        formControlName="keyFilter"-->
                <!--                        appendTo=""-->
                <!--                        [readonly]="row.value.typeFilter === null"-->
                <!--                        class="edit-select"-->
                <!--                      >-->
                <!--                        <ng-option *ngFor="let item of listChangeFilter[i]" [value]="item?.value">-->
                <!--                          {{item?.name}}-->
                <!--                        </ng-option>-->
                <!--                      </ng-select>-->
                <!--                    </td>-->
                <!--                    <td class="d-flex justify-content-end align-items-center">-->
                <!--                      <div *ngIf="i >= 1"-->
                <!--                           style="cursor: pointer;margin-top: 8px; margin-right: 2px">-->
                <!--                        <svg width="13" height="12" viewBox="0 0 13 12" fill="none"-->
                <!--                             xmlns="http://www.w3.org/2000/svg">-->
                <!--                          <path-->
                <!--                            d="M6.03272 0C2.69663 0 0 2.682 0 6C0 9.318 2.69663 12 6.03272 12C9.36882 12 12.0654 9.318 12.0654 6C12.0654 2.682 9.36882 0 6.03272 0ZM8.6268 8.58C8.57098 8.63562 8.50469 8.67975 8.43171 8.70986C8.35873 8.73997 8.2805 8.75547 8.20149 8.75547C8.12248 8.75547 8.04425 8.73997 7.97127 8.70986C7.89829 8.67975 7.83199 8.63562 7.77618 8.58L6.03272 6.846L4.28927 8.58C4.17647 8.69219 4.02348 8.75521 3.86396 8.75521C3.70444 8.75521 3.55145 8.69219 3.43865 8.58C3.32585 8.46781 3.26249 8.31566 3.26249 8.157C3.26249 8.07844 3.27804 8.00065 3.30827 7.92807C3.3385 7.8555 3.3828 7.78955 3.43865 7.734L5.18211 6L3.43865 4.266C3.32585 4.15381 3.26249 4.00166 3.26249 3.843C3.26249 3.68434 3.32585 3.53219 3.43865 3.42C3.55145 3.30781 3.70444 3.24479 3.86396 3.24479C4.02348 3.24479 4.17647 3.30781 4.28927 3.42L6.03272 5.154L7.77618 3.42C7.83203 3.36445 7.89834 3.32039 7.97131 3.29032C8.04429 3.26026 8.1225 3.24479 8.20149 3.24479C8.28048 3.24479 8.35869 3.26026 8.43166 3.29032C8.50464 3.32039 8.57094 3.36445 8.6268 3.42C8.68265 3.47555 8.72695 3.5415 8.75718 3.61407C8.78741 3.68665 8.80296 3.76444 8.80296 3.843C8.80296 3.92156 8.78741 3.99935 8.75718 4.07193C8.72695 4.1445 8.68265 4.21045 8.6268 4.266L6.88334 6L8.6268 7.734C8.85604 7.962 8.85604 8.346 8.6268 8.58Z"-->
                <!--                            fill="#FF313C"/>-->
                <!--                        </svg>-->
                <!--                      </div>-->
                <!--                      <div style="margin-top: 8px" *ngIf="i < 1">-->
                <!--                        <nb-icon (click)="addRowFilterSelected(i)" nbTooltip="{{'Add'}}"-->
                <!--                                 style="cursor: pointer;color:#0F70F5"-->
                <!--                                 icon="plus-circle-outline"-->
                <!--                                 pack="eva"></nb-icon>-->
                <!--                      </div>-->
                <!--                    </td>-->
                <!--                  </tr>-->
                <!--                </table>-->
                <div *ngIf="listFilterSelected.length !== 0"
                     style="max-height: 245px;background: var(--bg-back);overflow-y: auto;overflow-x: hidden;margin: 0 45px 0 18px;border-radius: 5px;padding: 5px;">
                  <table style="width:100%;">
                    <tr class="table-row-listUser-header">
                      <th style="width: 50%"></th>
                      <th style="width: 50%"></th>
                      <th></th>
                    </tr>
                    <tr *ngFor="let row of listFilterSelected; let i = index" class="table-list-user">
                      <td class="position-relative">
                        <span>{{row?.typeFilter}}</span>
                      </td>
                      <td style="padding-left: 22px">
                        <span>{{row?.keyFilter}}</span>
                      </td>
                      <td class="d-flex justify-content-end align-items-center">
                        <div (click)="deleteFilterSelected(i)" style="cursor: pointer; margin-right: 2px">
                          <svg width="13" height="12" viewBox="0 0 13 12" fill="none"
                               xmlns="http://www.w3.org/2000/svg">
                            <path
                              d="M6.03272 0C2.69663 0 0 2.682 0 6C0 9.318 2.69663 12 6.03272 12C9.36882 12 12.0654 9.318 12.0654 6C12.0654 2.682 9.36882 0 6.03272 0ZM8.6268 8.58C8.57098 8.63562 8.50469 8.67975 8.43171 8.70986C8.35873 8.73997 8.2805 8.75547 8.20149 8.75547C8.12248 8.75547 8.04425 8.73997 7.97127 8.70986C7.89829 8.67975 7.83199 8.63562 7.77618 8.58L6.03272 6.846L4.28927 8.58C4.17647 8.69219 4.02348 8.75521 3.86396 8.75521C3.70444 8.75521 3.55145 8.69219 3.43865 8.58C3.32585 8.46781 3.26249 8.31566 3.26249 8.157C3.26249 8.07844 3.27804 8.00065 3.30827 7.92807C3.3385 7.8555 3.3828 7.78955 3.43865 7.734L5.18211 6L3.43865 4.266C3.32585 4.15381 3.26249 4.00166 3.26249 3.843C3.26249 3.68434 3.32585 3.53219 3.43865 3.42C3.55145 3.30781 3.70444 3.24479 3.86396 3.24479C4.02348 3.24479 4.17647 3.30781 4.28927 3.42L6.03272 5.154L7.77618 3.42C7.83203 3.36445 7.89834 3.32039 7.97131 3.29032C8.04429 3.26026 8.1225 3.24479 8.20149 3.24479C8.28048 3.24479 8.35869 3.26026 8.43166 3.29032C8.50464 3.32039 8.57094 3.36445 8.6268 3.42C8.68265 3.47555 8.72695 3.5415 8.75718 3.61407C8.78741 3.68665 8.80296 3.76444 8.80296 3.843C8.80296 3.92156 8.78741 3.99935 8.75718 4.07193C8.72695 4.1445 8.68265 4.21045 8.6268 4.266L6.88334 6L8.6268 7.734C8.85604 7.962 8.85604 8.346 8.6268 8.58Z"
                              fill="#FF313C"/>
                          </svg>
                        </div>
                      </td>
                    </tr>
                  </table>
                </div>
                <div class="d-flex edit-button justify-content-center align-items-center mt-3 mb-3">
                  <button  (click)="filterSearchTable()"
                          style="min-width: 60px" class="mr-2">Filter
                  </button>
                  <button (click)="closePupupFilter()" style="min-width: 60px" class="edit-button-cancel mr-4">Clear
                  </button>
                  <!--                  <div class="d-flex align-items-center edit-checkbox">-->
                  <!--                    <nb-checkbox (change)="exactly($event)">{{'lookupTable.findExactly' | translate}}</nb-checkbox>-->
                  <!--                  </div>-->
                </div>
              </div>
            </div>
            <div style="margin-left: 10px" class="edit-button">
              <button
                *hasAnyAuthority="authority.LB_CONNECTION.LB_CONNECTION_WRITE"
                (click)="setValueForm();this.dialogService.open(addOrEdit, {context:{title: 'add'},closeOnBackdropClick:false})">
                <nb-icon icon="plus-outline"></nb-icon>
                {{'Mở kết nối'}}
              </button>
            </div>
          </div>
        </div>
        <div (click)="closePupup()" style="margin-bottom: 49px">
          <ngx-datatable class="dark fullscreen" #table
                         [columnMode]="'force'"
                         [limit]="limit"
                         [rows]="rowData"
                         [headerHeight]="'auto'"
                         [rowHeight]="'auto'"
                         [footerHeight]="'auto'"
                         [columns]="columnsTable"
                         [messages]="{totalMessage: 'data-ingestion.label.record' | translate}">
            <ng-container *ngFor="let col of columnsTable">
              <ngx-datatable-column prop="{{col.prop}}" name="{{col.name | translate}}" [flexGrow]="col.flexGrow"
                                    [sortable]="false">
                <ng-template let-column="column" ngx-datatable-header-template>
                  <ng-container [ngSwitch]="col.prop">
                    <ng-container *ngSwitchDefault>
                      {{ column.name |translate }}
                    </ng-container>
                    <ng-container *ngSwitchCase="'stt'">
                      <div class="text-center"><span class="w-100">{{ column.name |translate}}</span></div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'status'">
                      <div class="text-center"><span class="w-100">{{ column.name |translate}}</span></div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'action'">
                      <div style="text-align: center"><span class="w-100">{{ column.name |translate}}</span></div>
                    </ng-container>
                  </ng-container>
                </ng-template>
                <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                  <ng-container [ngSwitch]="col.prop">
                    <ng-container *ngSwitchCase="'stt'">
                      <div class="text-center">{{row?.id}}</div>
                    </ng-container>
                    <ng-container *ngSwitchDefault>
                      <span [title]="value"> {{ value ? value : 'N/A' }} </span>
                    </ng-container>
                    <ng-container *ngSwitchCase="'status'">
                      <div *ngIf="value === 1" class="edit-status-active">
                        <div class="status-bg-opacity"></div>
                        <div class="custom-show-data status-greend">Active
                        </div>
                      </div>
                      <div *ngIf="value === 0" class="edit-status-lock">
                        <div class="status-bg-opacity"></div>
                        <div class="custom-show-data status-red"
                        >Lock
                        </div>
                      </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'action'">
                      <div
                        *hasAnyAuthority="authority.LB_CONNECTION.LB_CONNECTION_WRITE"
                        class="w-100 d-flex justify-content-center">
                        <button class="edit"
                                status="warning" nbButton ghost
                                nbTooltip="{{'data-ingestion.label.edit'| translate}}"
                                (click)="editItems(row);this.checkDate = false;this.dialogService.open(addOrEdit, {context:{title: 'edit',id: row?.id},closeOnBackdropClick:false})"
                        >
                          <nb-icon icon="edit-outline" pack="eva" size="tiny"></nb-icon>
                        </button>
                        <button
                          *ngIf="row.status === 1"
                          nbButton
                          ghost
                          nbTooltip="{{'lock'}}"
                          (click)="this.dialogService.open(confirmLock, {context:{title: 'lock', item: row},closeOnBackdropClick:false})"
                        >
                          <nb-icon icon="lock-outline" pack="eva" size="tiny"></nb-icon>
                        </button>
                        <button
                          *ngIf="row.status === 0"
                          nbButton
                          status="danger" ghost
                          nbTooltip="{{'unLock'}}"
                          (click)="this.dialogService.open(confirmLock, {context:{title: 'unLock', item: row},closeOnBackdropClick:false})"
                        >
                          <nb-icon icon="unlock-outline" pack="eva" size="tiny"></nb-icon>
                        </button>
                      </div>
                    </ng-container>
                  </ng-container>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-footer>
                <ng-template
                  ngx-datatable-footer-template
                  let-rowCount="rowCount"
                  let-pageSize="pageSize"
                  let-selectedCount="selectedCount"
                  let-curPage="curPage"
                  let-offset="offset">
                  <div style="padding: 5px 10px;width:200px">
                    <div *ngIf="rowCount > 0">
                    <span>{{'Hiển thị' | translate}} {{(curPage - 1) * limit + 1}}
                      - {{rowCount - curPage * limit >= 0 ? (curPage - 1) * limit + limit : rowCount}}
                      /{{rowCount}} {{'bản ghi' | translate}}</span>
                    </div>
                    <div *ngIf="rowCount === 0">
                      <span>0 {{'data-ingestion.label.record' | translate}}</span>
                    </div>
                  </div>
                  <datatable-pager
                    [pagerLeftArrowIcon]="'datatable-icon-left'"
                    [pagerRightArrowIcon]="'datatable-icon-right'"
                    [page]="curPage"
                    [size]="pageSize"
                    [count]="rowCount"
                    [hidden]="!((rowCount / pageSize) > 1)"
                    (change)="table.onFooterPage($event)">
                  </datatable-pager>
                </ng-template>
              </ngx-datatable-footer>
            </ng-container>
          </ngx-datatable>
        </div>
      </nb-card-body>
    </nb-card>
  </nb-layout-column>
</nb-layout>

<ng-template #updateAuthen let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header class="d-flex edit-button justify-content-md-between">
      <span>Cập nhật</span>
      <button size="small" (click)="ref.close()">
        <nb-icon icon="close-outline"></nb-icon>
      </button>
    </nb-card-header>
    <nb-card-body>
      {{ data.status === 0 ? 'Bạn có chắc chắn muốn từ chối bản ghi này' : 'Bạn có chắc chắn muốn duyệt bản ghi này' }}
    </nb-card-body>
    <nb-card-footer class="d-flex edit-button justify-content-end">
      <button (click)="updateAuthConnection(data, ref)" class="mr-2">
        Đồng ý
      </button>
      <button class="edit-button-cancel" (click)="ref.close()">
        Hủy bỏ
      </button>
    </nb-card-footer>
  </nb-card>
</ng-template>
<ng-template #confirmLock let-data let-ref="dialogRef">
  <nb-card style="width: 400px">
    <nb-card-header class="d-flex justify-content-md-between">
      <span>{{data.title === 'lock' ? 'Lock' : 'Unlock'}}</span>
      <button style="background: none; border: none; color: #8C95B2" size="small" (click)="ref.close()">
        <nb-icon icon="close-outline" style="font-size: 20px"></nb-icon>
      </button>
    </nb-card-header>
    <nb-card-body>
      {{ data.title === 'unLock' ? 'Do you want to unlock?' : 'Do you want to lock ?' }}
    </nb-card-body>
    <nb-card-footer class="d-flex edit-button justify-content-center">
      <button class="mr-2" (click)="lockOrUnlock(ref,data.item,data.title)">
        Confirm
      </button>
      <button class="edit-button-cancel" (click)="ref.close()">
        Cancel
      </button>
    </nb-card-footer>
  </nb-card>
</ng-template>
<ng-template #addOrEdit let-data let-ref="dialogRef">
  <nb-card style="min-width: 735px">
    <nb-card-header class="d-flex  justify-content-md-between">
      <span *ngIf="data.title === 'add'">Mở kết nối</span>
      <span *ngIf="data.title === 'edit'">Chỉnh sửa yêu cầu: </span>
      <button style="background: none; border: none; color: #8C95B2" size="small" (click)="ref.close()">
        <nb-icon icon="close-outline" style="font-size: 20px"></nb-icon>
      </button>
    </nb-card-header>
    <nb-card-body [formGroup]="formGroupLB" style="overflow: visible">
      <div class="row mb-4">
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                User*:
              </div>
            </div>
            <div class="col-9 position-relative">
              <ng-select (change)="changeUser($event)" appendTo="" [readonly]="data.title === 'edit'"
                         formControlName="userId">
                <ng-option
                  *ngFor="let item of listUsers" [value]="item?.id">
                  <span showTooltip>{{item?.login}}</span></ng-option>
              </ng-select>
              <ngx-inline-message style="position: absolute;top: 86%;" [message]="'User'"
                                  [formName]="formGroupLB.get('userId')"></ngx-inline-message>
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                IP:
              </div>
            </div>
            <div class="col-9">
              <ng-select appendTo="" formControlName="userIpId" [readonly]="data.title === 'edit'">
                <ng-option

                  *ngFor="let item of listIp" [value]="item?.id">
                  <span showTooltip>{{item?.ipAddress}}</span></ng-option>
              </ng-select>
            </div>
          </div>
        </div>
      </div>
      <div class="row mb-4">
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                RP_App*:
              </div>
            </div>
            <div class="col-9 position-relative">
              <ng-select
                (change)="changeRPApp($event)"
                formControlName="rpAppId"
                appendTo=""
                [readonly]="data.title === 'edit'"
              >
                <ng-option
                  *ngFor="let item of listLbRpApp" [value]="item?.id">
                  <span showTooltip>{{item?.name}}</span></ng-option>
              </ng-select>
              <ngx-inline-message style="position: absolute;top: 86%;" [message]="'RP_App'"
                                  [formName]="formGroupLB.get('rpAppId')"></ngx-inline-message>
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                Thrift:
              </div>
            </div>
            <div class="col-9">
              <ng-select
                [readonly]="data.title === 'edit'"
                formControlName="rpAppThriftId"
                appendTo=""
              >
                <ng-option
                  *ngFor="let item of listThriftId" [value]="item?.rpAppThriftId">
                  <span showTooltip>{{item?.name}}</span></ng-option>
              </ng-select>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="data.title === 'edit'" class="row mb-4">
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                Bắt đầu:
              </div>
            </div>
            <div class="col-9">
              <div class="position-relative">
                <p-calendar [style]="{'width':'100%'}" [showSeconds]="true" [showTime]="true"
                            [showIcon]="true"
                            [disabled]="data.title === 'edit'"
                            formControlName="startDate"
                            dateFormat="yy-mm-dd"></p-calendar>
                <small style="font-size: 10px;left: 0;top: 95%;" *ngIf="checkDate"
                       class="text-danger position-absolute">{{'Ngày bắt đầu >= ngày hiện tại và <= ngày kết thúc'}}</small>
              </div>
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                File:
              </div>

            </div>
            <div class="col-9 position-relative">
              <div class="d-flex align-items-center">
                <input style="overflow: hidden;text-overflow: ellipsis;font-size: 12px" required class="input-edit"
                       formControlName="fileName" nbInput readonly fullWidth trim="blur">
                <button *ngIf="formGroupLB.value.fileName !== ''" (click)="clearFileName()"
                        style="background: var(--bg-back); border: 1px solid var(--border-select-dropdown) !important; color: #8C95B2; height: 35px;border-radius: 0px 5px 5px 0px;"
                        size="small">
                  <nb-icon [icon]="'close-circle-outline'"></nb-icon>
                </button>
              </div>
              <div *ngIf="formGroupLB.value.fileName === ''" class="position-absolute" style="top: 16%;left: 10%;">
                <label style="color: #0F70F5;font-weight: 600;font-size: 12px; margin-top: 2px; cursor: pointer"
                       for="attach-file"
                       class="attach mr-2 d-flex align-items-center">
                  <nb-icon style="margin-right: 9px;font-size: 15px" [icon]="'cloud-upload-outline'"></nb-icon>
                  Browser file
                </label>
                <input style="display: none" id="attach-file" nbInput type="file" name="attach-file" accept="*"
                       (change)="onFileChange($event)"
                       required/>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="data.title === 'edit'" class="row mb-4">
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                Kết thúc:
              </div>
            </div>
            <div class="col-9">
              <div>
                <p-calendar [style]="{'width':'100%'}" [showSeconds]="true" [showTime]="true"
                            [showIcon]="true"
                            formControlName="endDate"
                            dateFormat="yy-mm-dd"></p-calendar>
              </div>
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                Status:
              </div>
            </div>
            <div class="col-9">
              <ng-select
                [hideSelected]="true"
                [closeOnSelect]="true"
                bindLabel="name"
                bindValue="value"
                formControlName="status"
                appendTo=""
                [items]="listStatus"
              >
              </ng-select>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="data.title === 'add'" class="row mb-4">
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                Kết thúc:
              </div>
            </div>
            <div class="col-9">
              <div>
                <p-calendar [style]="{'width':'100%'}" [showSeconds]="true" [showTime]="true"
                            [showIcon]="true"
                            formControlName="endDate"
                            dateFormat="yy-mm-dd"></p-calendar>
              </div>
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="row">
            <div class="col-3">
              <div style="height: 100%" class="d-flex align-items-center">
                File:
              </div>
            </div>
            <div class="col-9 position-relative">
              <div class="d-flex align-items-center">
                <input style="overflow: hidden;text-overflow: ellipsis;font-size: 12px" required class="input-edit"
                       formControlName="fileName" nbInput readonly fullWidth trim="blur">
                <button *ngIf="formGroupLB.value.fileName !== ''" (click)="clearFileName()"
                        style="background: var(--bg-back); border: 1px solid var(--border-select-dropdown) !important; color: #8C95B2; height: 35px;border-radius: 0px 5px 5px 0px;"
                        size="small">
                  <nb-icon [icon]="'close-circle-outline'"></nb-icon>
                </button>
              </div>
              <div *ngIf="formGroupLB.value.fileName === ''" class="position-absolute" style="top: 16%;left: 10%;">
                <label style="color: #0F70F5;font-weight: 600;font-size: 12px; margin-top: 2px; cursor: pointer"
                       for="attach-files"
                       class="attach mr-2 d-flex align-items-center">
                  <nb-icon style="margin-right: 9px;font-size: 15px" [icon]="'cloud-upload-outline'"></nb-icon>
                  Browser file
                </label>
                <input style="display: none" id="attach-files" nbInput type="file" name="attach-file" accept="*"
                       (change)="onFileChange($event)"
                       required/>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div style="margin: 0" class="row">
        <div class="custom-textarea d-flex justify-content-between">
          <span>Lý do:</span>
          <div class="custom-textarea__item">
            <textarea formControlName="reason" class="edit-text-area"></textarea>
          </div>
        </div>
      </div>
    </nb-card-body>
    <nb-card-footer class="d-flex edit-button justify-content-center align-items-center">
      <button [disabled]="(formGroupLB.value.userId === null || formGroupLB.value.rpAppId === null ) && (data.title === 'edit')"
              (click)="addOrEditConnection(data.title, ref, data.id)" class="mr-2">
        Xác nhận
      </button>
      <button class="edit-button-cancel" (click)="ref.close()">
        Hủy
      </button>
    </nb-card-footer>
  </nb-card>
</ng-template>
